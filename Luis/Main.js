"use strict";
var Test;
(function (Test) {
    var fudge = FudgeCore;
    window.addEventListener("load", hndLoad);
    let sphereColor = fudge.Color.CSS("GREEN");
    let sphereSize = 25;
    let ambIntensity = 0.2;
    let dirIntensity = 0.7;
    let shininess = 200;
    let dirRotation = new fudge.Vector3(0, 0, 0);
    let shaders = [fudge.ShaderFlat, fudge.ShaderGouraud, fudge.ShaderPhong];
    function hndLoad(_event) {
        const canvas0 = document.getElementById("c0");
        const canvas1 = document.getElementById("c1");
        const canvas2 = document.getElementById("c2");
        fudge.Render.initialize();
        Test.viewport0 = new fudge.Viewport();
        Test.viewport1 = new fudge.Viewport();
        Test.viewport2 = new fudge.Viewport();
        //FLAT
        // fudge.ShaderModular.addVertexShaderModule([
        //     fudge.SHADER_MODULE.LIGHTS, 
        //     fudge.SHADER_MODULE.MATRIX_WORLD,
        //     fudge.SHADER_MODULE.MATRIX_PROJECTION,
        //     fudge.SHADER_MODULE.NORMAL_FACE, 
        //     fudge.SHADER_MODULE.COLOR_OUT_FLAT, 
        //     fudge.SHADER_MODULE.FLAT_VERT_MAIN
        // ]);
        // fudge.ShaderModular.addFragmentShaderModule([
        //     fudge.SHADER_MODULE.COLOR_U, 
        //     fudge.SHADER_MODULE.COLOR_IN_FLAT, 
        //     fudge.SHADER_MODULE.FRAG_OUT, 
        //     fudge.SHADER_MODULE.FLAT_FRAG_MAIN
        // ]);
        //GOURAUD
        // fudge.ShaderModular.addVertexShaderModule([
        //     fudge.SHADER_MODULE.LIGHTS, 
        //     fudge.SHADER_MODULE.MATRIX_WORLD, 
        //     fudge.SHADER_MODULE.COLOR_OUT,
        //     fudge.SHADER_MODULE.NORMAL_VERTEX, 
        //     fudge.SHADER_MODULE.MATRIX_PROJECTION, 
        //     fudge.SHADER_MODULE.SHININESS,
        //     fudge.SHADER_MODULE.REFLECTION, 
        //     fudge.SHADER_MODULE.GOURAUD_VERT_MAIN
        // ]);
        // fudge.ShaderModular.addFragmentShaderModule([
        //     fudge.SHADER_MODULE.COLOR_U, 
        //     fudge.SHADER_MODULE.COLOR_IN, 
        //     fudge.SHADER_MODULE.FRAG_OUT, 
        //     fudge.SHADER_MODULE.GOURAUD_FRAG_MAIN
        // ]);
        //PHONG
        // fudge.ShaderModular.addVertexShaderModule([
        //     fudge.SHADER_MODULE.MATRIX_WORLD,
        //     fudge.SHADER_MODULE.MATRIX_PROJECTION, 
        //     fudge.SHADER_MODULE.MATRIX_NORMAL,
        //     fudge.SHADER_MODULE.NORMAL_VERTEX, 
        //     fudge.SHADER_MODULE.PHONG_VERT_MAIN
        // ]);
        // fudge.ShaderModular.addFragmentShaderModule([
        //     fudge.SHADER_MODULE.LIGHTS, 
        //     fudge.SHADER_MODULE.COLOR_U, 
        //     fudge.SHADER_MODULE.SHININESS,
        //     fudge.SHADER_MODULE.REFLECTION, 
        //     fudge.SHADER_MODULE.FRAG_OUT, 
        //     fudge.SHADER_MODULE.PHONG_FRAG_MAIN
        // ]);
        let sphere0 = new SphereWithLights("Sphere0", sphereColor, Test.ShaderCustom);
        let sphere1 = new SphereWithLights("Sphere1", sphereColor, shaders[1]);
        let sphere2 = new SphereWithLights("Sphere2", sphereColor, shaders[2]);
        let cmpCamera = new fudge.ComponentCamera();
        cmpCamera.mtxPivot.translateZ(-2);
        Test.viewport0.initialize("Viewport", sphere0, cmpCamera, canvas0);
        Test.viewport0.draw();
        Test.viewport1.initialize("Viewport", sphere1, cmpCamera, canvas1);
        Test.viewport1.draw();
        Test.viewport2.initialize("Viewport", sphere2, cmpCamera, canvas2);
        Test.viewport2.draw();
    }
    class SphereWithLights extends fudge.Node {
        constructor(_name, _color, _shader) {
            super(_name);
            this.sphere = new fudge.Node("");
            this.appendChild(this.sphere);
            let mtr = new fudge.Material("mtr" + _color.toString(), _shader, new fudge.CoatColored(_color, shininess));
            let cmpMaterial = new fudge.ComponentMaterial(mtr);
            this.sphere.addComponent(new fudge.ComponentMesh(new fudge.MeshSphere(sphereSize.toString(), sphereSize, sphereSize)));
            // this.sphere.addComponent(new fudge.ComponentMesh(new fudge.MeshObj(Object.obj)));
            this.sphere.addComponent(cmpMaterial);
            this.sphere.addComponent(new fudge.ComponentTransform());
            this.sphere.cmpTransform.mtxLocal.rotateX(0);
            let cmpLight = new fudge.ComponentLight(new fudge.LightDirectional(new fudge.Color(dirIntensity, dirIntensity, dirIntensity, 1)));
            let light = new fudge.Node("Light");
            light.addComponent(cmpLight);
            light.addComponent(new fudge.ComponentTransform());
            light.cmpTransform.mtxLocal.rotate(dirRotation);
            this.appendChild(light);
            let cmpLightAmb = new fudge.ComponentLight(new fudge.LightAmbient(new fudge.Color(ambIntensity, ambIntensity, ambIntensity, 1)));
            let lightAmb = new fudge.Node("LightAmb");
            lightAmb.addComponent(cmpLightAmb);
            this.appendChild(lightAmb);
        }
    }
    Test.SphereWithLights = SphereWithLights;
})(Test || (Test = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTWFpbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIk1haW4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQVUsSUFBSSxDQXNIYjtBQXRIRCxXQUFVLElBQUk7SUFDVixJQUFPLEtBQUssR0FBRyxTQUFTLENBQUM7SUFFekIsTUFBTSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztJQUt6QyxJQUFJLFdBQVcsR0FBZ0IsS0FBSyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDeEQsSUFBSSxVQUFVLEdBQVcsRUFBRSxDQUFDO0lBQzVCLElBQUksWUFBWSxHQUFXLEdBQUcsQ0FBQztJQUMvQixJQUFJLFlBQVksR0FBVyxHQUFHLENBQUM7SUFDL0IsSUFBSSxTQUFTLEdBQVcsR0FBRyxDQUFDO0lBQzVCLElBQUksV0FBVyxHQUFrQixJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUM1RCxJQUFJLE9BQU8sR0FBMEIsQ0FBQyxLQUFLLENBQUMsVUFBVSxFQUFFLEtBQUssQ0FBQyxhQUFhLEVBQUUsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBRWhHLFNBQVMsT0FBTyxDQUFDLE1BQWE7UUFDMUIsTUFBTSxPQUFPLEdBQXlDLFFBQVEsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDcEYsTUFBTSxPQUFPLEdBQXlDLFFBQVEsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDcEYsTUFBTSxPQUFPLEdBQXlDLFFBQVEsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDcEYsS0FBSyxDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUMxQixLQUFBLFNBQVMsR0FBRyxJQUFJLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUNqQyxLQUFBLFNBQVMsR0FBRyxJQUFJLEtBQUssQ0FB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WUFBWSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN2SixJQUFJLFFBQVEsR0FBZSxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDdEQsUUFBUSxDQUFDLFlBQVksQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUNuQyxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQy9CLENBQUM7S0FDSjtJQTFCWSxxQkFBZ0IsbUJBMEI1QixDQUFBO0FBQ0wsQ0FBQyxFQXRIUyxJQUFJLEtBQUosSUFBSSxRQXNIYiIsInNvdXJjZXNDb250ZW50IjpbIm5hbWVzcGFjZSBUZXN0IHtcclxuICAgIGltcG9ydCBmdWRnZSA9IEZ1ZGdlQ29yZTtcclxuXHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgaG5kTG9hZCk7XHJcbiAgICBleHBvcnQgbGV0IHZpZXdwb3J0MDogZnVkZ2UuVmlld3BvcnQ7XHJcbiAgICBleHBvcnQgbGV0IHZpZXdwb3J0MTogZnVkZ2UuVmlld3BvcnQ7XHJcbiAgICBleHBvcnQgbGV0IHZpZXdwb3J0MjogZnVkZ2UuVmlld3BvcnQ7XHJcblxyXG4gICAgbGV0IHNwaGVyZUNvbG9yOiBmdWRnZS5Db2xvciA9IGZ1ZGdlLkNvbG9yLkNTUyhcIkdSRUVOXCIpO1xyXG4gICAgbGV0IHNwaGVyZVNpemU6IG51bWJlciA9IDI1O1xyXG4gICAgbGV0IGFtYkludGVuc2l0eTogbnVtYmVyID0gMC4yO1xyXG4gICAgbGV0IGRpckludGVuc2l0eTogbnVtYmVyID0gMC43O1xyXG4gICAgbGV0IHNoaW5pbmVzczogbnVtYmVyID0gMjAwO1xyXG4gICAgbGV0IGRpclJvdGF0aW9uOiBmdWRnZS5WZWN0b3IzID0gbmV3IGZ1ZGdlLlZlY3RvcjMoMCwgMCwgMCk7XHJcbiAgICBsZXQgc2hhZGVyczogdHlwZW9mIGZ1ZGdlLlNoYWRlcltdID0gW2Z1ZGdlLlNoYWRlckZsYXQsIGZ1ZGdlLlNoYWRlckdvdXJhdWQsIGZ1ZGdlLlNoYWRlclBob25nXTtcclxuICAgIFxyXG4gICAgZnVuY3Rpb24gaG5kTG9hZChfZXZlbnQ6IEV2ZW50KTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgY2FudmFzMDogSFRNTENhbnZhc0VsZW1lbnQgPSA8SFRNTENhbnZhc0VsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjMFwiKTtcclxuICAgICAgICBjb25zdCBjYW52YXMxOiBIVE1MQ2FudmFzRWxlbWVudCA9IDxIVE1MQ2FudmFzRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImMxXCIpO1xyXG4gICAgICAgIGNvbnN0IGNhbnZhczI6IEhUTUxDYW52YXNFbGVtZW50ID0gPEhUTUxDYW52YXNFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYzJcIik7XHJcbiAgICAgICAgZnVkZ2UuUmVuZGVyLmluaXRpYWxpemUoKTtcclxuICAgICAgICB2aWV3cG9ydDAgPSBuZXcgZnVkZ2UuVmlld3BvcnQoKTtcclxuICAgICAgICB2aWV3cG9ydDEgPSBuZXcgZnVkZ2UuVmlld3BvcnQoKTtcclxuICAgICAgICB2aWV3cG9ydDIgPSBuZXcgZnVkZ2UuVmlld3BvcnQoKTtcclxuICAgICAgICBcclxuICAgICAgICAvL0ZMQVRcclxuICAgICAgICAvLyBmdWRnZS5TaGFkZXJNb2R1bGFyLmFkZFZlcnRleFNoYWRlck1vZHVsZShbXHJcbiAgICAgICAgLy8gICAgIGZ1ZGdlLlNIQURFUl9NT0RVTEUuTElHSFRTLCBcclxuICAgICAgICAvLyAgICAgZnVkZ2UuU0hBREVSX01PRFVMRS5NQVRSSVhfV09STEQsXHJcbiAgICAgICAgLy8gICAgIGZ1ZGdlLlNIQURFUl9NT0RVTEUuTUFUUklYX1BST0pFQ1RJT04sXHJcbiAgICAgICAgLy8gICAgIGZ1ZGdlLlNIQURFUl9NT0RVTEUuTk9STUFMX0ZBQ0UsIFxyXG4gICAgICAgIC8vICAgICBmdWRnZS5TSEFERVJfTU9EVUxFLkNPTE9SX09VVF9GTEFULCBcclxuICAgICAgICAvLyAgICAgZnVkZ2UuU0hBREVSX01PRFVMRS5GTEFUX1ZFUlRfTUFJTlxyXG4gICAgICAgIC8vIF0pO1xyXG4gICAgICAgIC8vIGZ1ZGdlLlNoYWRlck1vZHVsYXIuYWRkRnJhZ21lbnRTaGFkZXJNb2R1bGUoW1xyXG4gICAgICAgIC8vICAgICBmdWRnZS5TSEFERVJfTU9EVUxFLkNPTE9SX1UsIFxyXG4gICAgICAgIC8vICAgICBmdWRnZS5TSEFERVJfTU9EVUxFLkNPTE9SX0lOX0ZMQVQsIFxyXG4gICAgICAgIC8vICAgICBmdWRnZS5TSEFERVJfTU9EVUxFLkZSQUdfT1VULCBcclxuICAgICAgICAvLyAgICAgZnVkZ2UuU0hBREVSX01PRFVMRS5GTEFUX0ZSQUdfTUFJTlxyXG4gICAgICAgIC8vIF0pO1xyXG5cclxuICAgICAgICAvL0dPVVJBVURcclxuICAgICAgICAvLyBmdWRnZS5TaGFkZXJNb2R1bGFyLmFkZFZlcnRleFNoYWRlck1vZHVsZShbXHJcbiAgICAgICAgLy8gICAgIGZ1ZGdlLlNIQURFUl9NT0RVTEUuTElHSFRTLCBcclxuICAgICAgICAvLyAgICAgZnVkZ2UuU0hBREVSX01PRFVMRS5NQVRSSVhfV09STEQsIFxyXG4gICAgICAgIC8vICAgICBmdWRnZS5TSEFERVJfTU9EVUxFLkNPTE9SX09VVCxcclxuICAgICAgICAvLyAgICAgZnVkZ2UuU0hBREVSX01PRFVMRS5OT1JNQUxfVkVSVEVYLCBcclxuICAgICAgICAvLyAgICAgZnVkZ2UuU0hBREVSX01PRFVMRS5NQVRSSVhfUFJPSkVDVElPTiwgXHJcbiAgICAgICAgLy8gICAgIGZ1ZGdlLlNIQURFUl9NT0RVTEUuU0hJTklORVNTLFxyXG4gICAgICAgIC8vICAgICBmdWRnZS5TSEFERVJfTU9EVUxFLlJFRkxFQ1RJT04sIFxyXG4gICAgICAgIC8vICAgICBmdWRnZS5TSEFERVJfTU9EVUxFLkdPVVJBVURfVkVSVF9NQUlOXHJcbiAgICAgICAgLy8gXSk7XHJcbiAgICAgICAgLy8gZnVkZ2UuU2hhZGVyTW9kdWxhci5hZGRGcmFnbWVudFNoYWRlck1vZHVsZShbXHJcbiAgICAgICAgLy8gICAgIGZ1ZGdlLlNIQURFUl9NT0RVTEUuQ09MT1JfVSwgXHJcbiAgICAgICAgLy8gICAgIGZ1ZGdlLlNIQURFUl9NT0RVTEUuQ09MT1JfSU4sIFxyXG4gICAgICAgIC8vICAgICBmdWRnZS5TSEFERVJfTU9EVUxFLkZSQUdfT1VULCBcclxuICAgICAgICAvLyAgICAgZnVkZ2UuU0hBREVSX01PRFVMRS5HT1VSQVVEX0ZSQUdfTUFJTlxyXG4gICAgICAgIC8vIF0pO1xyXG5cclxuICAgICAgICAvL1BIT05HXHJcbiAgICAgICAgLy8gZnVkZ2UuU2hhZGVyTW9kdWxhci5hZGRWZXJ0ZXhTaGFkZXJNb2R1bGUoW1xyXG4gICAgICAgIC8vICAgICBmdWRnZS5TSEFERVJfTU9EVUxFLk1BVFJJWF9XT1JMRCxcclxuICAgICAgICAvLyAgICAgZnVkZ2UuU0hBREVSX01PRFVMRS5NQVRSSVhfUFJPSkVDVElPTiwgXHJcbiAgICAgICAgLy8gICAgIGZ1ZGdlLlNIQURFUl9NT0RVTEUuTUFUUklYX05PUk1BTCxcclxuICAgICAgICAvLyAgICAgZnVkZ2UuU0hBREVSX01PRFVMRS5OT1JNQUxfVkVSVEVYLCBcclxuICAgICAgICAvLyAgICAgZnVkZ2UuU0hBREVSX01PRFVMRS5QSE9OR19WRVJUX01BSU5cclxuICAgICAgICAvLyBdKTtcclxuICAgICAgICAvLyBmdWRnZS5TaGFkZXJNb2R1bGFyLmFkZEZyYWdtZW50U2hhZGVyTW9kdWxlKFtcclxuICAgICAgICAvLyAgICAgZnVkZ2UuU0hBREVSX01PRFVMRS5MSUdIVFMsIFxyXG4gICAgICAgIC8vICAgICBmdWRnZS5TSEFERVJfTU9EVUxFLkNPTE9SX1UsIFxyXG4gICAgICAgIC8vICAgICBmdWRnZS5TSEFERVJfTU9EVUxFLlNISU5JTkVTUyxcclxuICAgICAgICAvLyAgICAgZnVkZ2UuU0hBREVSX01PRFVMRS5SRUZMRUNUSU9OLCBcclxuICAgICAgICAvLyAgICAgZnVkZ2UuU0hBREVSX01PRFVMRS5GUkFHX09VVCwgXHJcbiAgICAgICAgLy8gICAgIGZ1ZGdlLlNIQURFUl9NT0RVTEUuUEhPTkdfRlJBR19NQUlOXHJcbiAgICAgICAgLy8gXSk7XHJcblxyXG4gICAgICAgIGxldCBzcGhlcmUwOiBmdWRnZS5Ob2RlID0gbmV3IFNwaGVyZVdpdGhMaWdodHMoXCJTcGhlcmUwXCIsIHNwaGVyZUNvbG9yLCBTaGFkZXJDdXN0b20pO1xyXG4gICAgICAgIGxldCBzcGhlcmUxOiBmdWRnZS5Ob2RlID0gbmV3IFNwaGVyZVdpdGhMaWdodHMoXCJTcGhlcmUxXCIsIHNwaGVyZUNvbG9yLCBzaGFkZXJzWzFdKTtcclxuICAgICAgICBsZXQgc3BoZXJlMjogZnVkZ2UuTm9kZSA9IG5ldyBTcGhlcmVXaXRoTGlnaHRzKFwiU3BoZXJlMlwiLCBzcGhlcmVDb2xvciwgc2hhZGVyc1syXSk7XHJcblxyXG4gICAgICAgIGxldCBjbXBDYW1lcmE6IGZ1ZGdlLkNvbXBvbmVudENhbWVyYSA9IG5ldyBmdWRnZS5Db21wb25lbnRDYW1lcmEoKTtcclxuICAgICAgICBjbXBDYW1lcmEubXR4UGl2b3QudHJhbnNsYXRlWigtMik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmlld3BvcnQwLmluaXRpYWxpemUoXCJWaWV3cG9ydFwiLCBzcGhlcmUwLCBjbXBDYW1lcmEsIGNhbnZhczApO1xyXG4gICAgICAgIHZpZXdwb3J0MC5kcmF3KCk7XHJcbiAgICAgICAgdmlld3BvcnQxLmluaXRpYWxpemUoXCJWaWV3cG9ydFwiLCBzcGhlcmUxLCBjbXBDYW1lcmEsIGNhbnZhczEpO1xyXG4gICAgICAgIHZpZXdwb3J0MS5kcmF3KCk7XHJcbiAgICAgICAgdmlld3BvcnQyLmluaXRpYWxpemUoXCJWaWV3cG9ydFwiLCBzcGhlcmUyLCBjbXBDYW1lcmEsIGNhbnZhczIpO1xyXG4gICAgICAgIHZpZXdwb3J0Mi5kcmF3KCk7XHJcbiAgICB9XHJcblxyXG4gICAgZXhwb3J0IGNsYXNzIFNwaGVyZVdpdGhMaWdodHMgZXh0ZW5kcyBmdWRnZS5Ob2RlIHtcclxuICAgICAgICBwcml2YXRlIHNwaGVyZTogZnVkZ2UuTm9kZTtcclxuICAgICAgICBwdWJsaWMgY29uc3RydWN0b3IoX25hbWU6IHN0cmluZywgX2NvbG9yOiBmdWRnZS5Db2xvciwgX3NoYWRlcjogdHlwZW9mIGZ1ZGdlLlNoYWRlcikge1xyXG4gICAgICAgICAgICBzdXBlcihfbmFtZSk7XHJcbiAgICAgICAgICAgIHRoaXMuc3BoZXJlID0gbmV3IGZ1ZGdlLk5vZGUoXCJcIik7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwZW5kQ2hpbGQodGhpcy5zcGhlcmUpO1xyXG4gICAgICAgICAgICBsZXQgbXRyOiBmdWRnZS5NYXRlcmlhbCA9IG5ldyBmdWRnZS5NYXRlcmlhbChcIm10clwiICsgX2NvbG9yLnRvU3RyaW5nKCksIF9zaGFkZXIsIG5ldyBmdWRnZS5Db2F0Q29sb3JlZChfY29sb3IsIHNoaW5pbmVzcykpO1xyXG4gICAgICAgICAgICBsZXQgY21wTWF0ZXJpYWw6IGZ1ZGdlLkNvbXBvbmVudE1hdGVyaWFsID0gbmV3IGZ1ZGdlLkNvbXBvbmVudE1hdGVyaWFsKG10cik7XHJcbiAgICAgICAgICAgIHRoaXMuc3BoZXJlLmFkZENvbXBvbmVudChuZXcgZnVkZ2UuQ29tcG9uZW50TWVzaChuZXcgZnVkZ2UuTWVzaFNwaGVyZShzcGhlcmVTaXplLnRvU3RyaW5nKCksIHNwaGVyZVNpemUsIHNwaGVyZVNpemUpKSk7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuc3BoZXJlLmFkZENvbXBvbmVudChuZXcgZnVkZ2UuQ29tcG9uZW50TWVzaChuZXcgZnVkZ2UuTWVzaE9iaihPYmplY3Qub2JqKSkpO1xyXG4gICAgICAgICAgICB0aGlzLnNwaGVyZS5hZGRDb21wb25lbnQoY21wTWF0ZXJpYWwpO1xyXG4gICAgICAgICAgICB0aGlzLnNwaGVyZS5hZGRDb21wb25lbnQobmV3IGZ1ZGdlLkNvbXBvbmVudFRyYW5zZm9ybSgpKTtcclxuICAgICAgICAgICAgdGhpcy5zcGhlcmUuY21wVHJhbnNmb3JtLm10eExvY2FsLnJvdGF0ZVgoMCk7XHJcblxyXG4gICAgICAgICAgICBsZXQgY21wTGlnaHQ6IGZ1ZGdlLkNvbXBvbmVudExpZ2h0ID0gbmV3IGZ1ZGdlLkNvbXBvbmVudExpZ2h0KG5ldyBmdWRnZS5MaWdodERpcmVjdGlvbmFsKG5ldyBmdWRnZS5Db2xvcihkaXJJbnRlbnNpdHksIGRpckludGVuc2l0eSwgZGlySW50ZW5zaXR5LCAxKSkpO1xyXG4gICAgICAgICAgICBsZXQgbGlnaHQ6IGZ1ZGdlLk5vZGUgPSBuZXcgZnVkZ2UuTm9kZShcIkxpZ2h0XCIpO1xyXG4gICAgICAgICAgICBsaWdodC5hZGRDb21wb25lbnQoY21wTGlnaHQpO1xyXG4gICAgICAgICAgICBsaWdodC5hZGRDb21wb25lbnQobmV3IGZ1ZGdlLkNvbXBvbmVudFRyYW5zZm9ybSgpKTtcclxuICAgICAgICAgICAgbGlnaHQuY21wVHJhbnNmb3JtLm10eExvY2FsLnJvdGF0ZShkaXJSb3RhdGlvbik7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwZW5kQ2hpbGQobGlnaHQpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGNtcExpZ2h0QW1iOiBmdWRnZS5Db21wb25lbnRMaWdodCA9IG5ldyBmdWRnZS5Db21wb25lbnRMaWdodChuZXcgZnVkZ2UuTGlnaHRBbWJpZW50KG5ldyBmdWRnZS5Db2xvcihhbWJJbnRlbnNpdHksIGFtYkludGVuc2l0eSwgYW1iSW50ZW5zaXR5LCAxKSkpO1xyXG4gICAgICAgICAgICBsZXQgbGlnaHRBbWI6IGZ1ZGdlLk5vZGUgPSBuZXcgZnVkZ2UuTm9kZShcIkxpZ2h0QW1iXCIpO1xyXG4gICAgICAgICAgICBsaWdodEFtYi5hZGRDb21wb25lbnQoY21wTGlnaHRBbWIpO1xyXG4gICAgICAgICAgICB0aGlzLmFwcGVuZENoaWxkKGxpZ2h0QW1iKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iXX0=